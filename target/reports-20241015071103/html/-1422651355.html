<html>
 <head> 
  <style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style> 
 </head> 
 <body>
  <h1>SATD</h1>
  <table>
   <tbody>
    <tr>
     <th>satd id</th> 
     <th>satd instance id</th> 
     <th>project</th> 
     <th>committer name </th> 
     <th> Commit Hash</th> 
     <th>old comment</th> 
     <th>New Comment</th> 
     <th>resolution</th> 
     <th>Method Signature</th> 
     <th>Method Declaration</th> 
     <th>Method Body</th> 
    </tr>
    <tr>
     <td>1387</td> 
     <td>-1422651355</td>
     <td>apache/camel</td>
     <td>Claus Ibsen</td>
     <td>2ed5a6183a2312eb4e178210c0e9ff0652450799</td> 
     <td>content type should match TODO: content type does not work with geronomi mail jar (its a buggy jar, use SUN mail jar instead)</td> 
     <td>content type should match</td> 
     <td>SATD_REMOVED</td> 
     <td>testSendAndRecieveMailWithAttachments()</td> 
     <td>public void testSendAndRecieveMailWithAttachments() throws Exception</td> 
     <td> // START SNIPPET: e1 // create an exchange with a normal body and attachment to be produced as email Endpoint endpoint = context.getEndpoint("smtp://james@mymailserver.com?password=secret&amp;contentType=text/html"); // create the exchange with the mail message that is multipart with a file and a Hello World text/plain message. Exchange exchange = endpoint.createExchange(); Message in = exchange.getIn(); in.setBody("<h1>Hello</h1>World"); in.addAttachment("logo.jpeg", new DataHandler(new FileDataSource("src/test/data/logo.jpeg"))); // create a producer that can produce the exchange (= send the mail) Producer producer = endpoint.createProducer(); // start the producer producer.start(); // and let it go (processes the exchange by sending the email) producer.process(exchange); // END SNIPPET: e1 // need some time for the mail to arrive on the inbox (consumed and sent to the mock) Thread.sleep(2000); MockEndpoint mock = getMockEndpoint("mock:result"); mock.expectedMessageCount(1); Exchange out = mock.assertExchangeReceived(0); mock.assertIsSatisfied(); // plain text assertEquals("<h1>Hello</h1>World", out.getIn().getBody(String.class)); // attachment Map<string, datahandler>
        attachments = out.getIn().getAttachments(); assertNotNull("Should have attachments", attachments); assertEquals(1, attachments.size()); DataHandler handler = out.getIn().getAttachment("logo.jpeg"); assertNotNull("The logo should be there", handler); byte[] bytes = context.getTypeConverter().convertTo(byte[].class, handler.getInputStream()); assertNotNull("content should be there", bytes); assertTrue("logo should be more than 1000 bytes", bytes.length &gt; 1000); // content type should match assertEquals("image/jpeg; name=logo.jpeg", handler.getContentType()); // save logo for visual inspection template.sendBodyAndHeader("file://target", bytes, Exchange.FILE_NAME, "maillogo.jpg"); producer.stop(); 
      </string,></td> 
    </tr>
   </tbody>
   <tbody>
    <tr>
     <td>1353</td> 
     <td>-1422651355</td>
     <td>apache/camel</td>
     <td>Claus Ibsen</td>
     <td>59cdca832ee8ad86de121605d968a3c07f51e4b1</td> 
     <td>None</td> 
     <td>content type should match TODO: content type does not work with geronomi mail jar (its a buggy jar, use SUN mail jar instead)</td> 
     <td>SATD_ADDED</td> 
     <td>testSendAndRecieveMailWithAttachments()</td> 
     <td>public void testSendAndRecieveMailWithAttachments() throws Exception</td> 
     <td> // START SNIPPET: e1 // create an exchange with a normal body and attachment to be produced as email Endpoint endpoint = context.getEndpoint("smtp://james@mymailserver.com?password=secret&amp;contentType=text/html"); // create the exchange with the mail message that is multipart with a file and a Hello World text/plain message. Exchange exchange = endpoint.createExchange(); Message in = exchange.getIn(); in.setBody("<h1>Hello</h1>World"); in.addAttachment("logo.jpeg", new DataHandler(new FileDataSource("src/test/data/logo.jpeg"))); // create a producer that can produce the exchange (= send the mail) Producer producer = endpoint.createProducer(); // start the producer producer.start(); // and let it go (processes the exchange by sending the email) producer.process(exchange); // END SNIPPET: e1 // need some time for the mail to arrive on the inbox (consumed and sent to the mock) Thread.sleep(1500); MockEndpoint mock = getMockEndpoint("mock:result"); mock.expectedMessageCount(1); Exchange out = mock.assertExchangeReceived(0); mock.assertIsSatisfied(); // plain text assertEquals("<h1>Hello</h1>World", out.getIn().getBody(String.class)); // attachment Map<string, datahandler>
        attachments = out.getIn().getAttachments(); assertNotNull("Should have attachments", attachments); assertEquals(1, attachments.size()); DataHandler handler = out.getIn().getAttachment("logo.jpeg"); assertNotNull("The logo should be there", handler); byte[] bytes = context.getTypeConverter().convertTo(byte[].class, handler.getInputStream()); assertNotNull("content should be there", bytes); assertTrue("logo should be more than 1000 bytes", bytes.length &gt; 1000); // content type should match // TODO: content type does not work with geronomi mail jar (its a buggy jar, use SUN mail jar instead) // assertEquals("image/jpeg; name=logo.jpeg", handler.getContentType()); // save logo for visual inspection template.sendBodyAndHeader("file://target", bytes, Exchange.FILE_NAME, "maillogo.jpg"); producer.stop(); 
      </string,></td> 
    </tr>
   </tbody>
  </table>
 </body>
</html>