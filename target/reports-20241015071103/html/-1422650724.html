<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>2476</td> <td>-1422650724</td><td>apache/camel</td><td>Claus Ibsen</td><td>096c866aec42fec18b9eddb5809a24e27e43f902</td> <td>None</td> <td>the loop finished, persist the lastValue just in case we are shutting down
TODO: perhaps add a functionality to persist every N records</td> <td>SATD_ADDED</td> <td>doRun()</td> <td>private void doRun()</td> <td>
    // while the cursor has more values, keepRunning is true and the cursorId is not 0, which symbolizes that the cursor is dead
    try {
        while (cursor.hasNext() && cursor.getCursorId() != 0 && keepRunning) {
            DBObject dbObj = cursor.next();
            Exchange exchange = endpoint.createMongoDbExchange(dbObj);
            try {
                if (LOG.isTraceEnabled()) {
                    LOG.trace("Sending exchange: {}, ObjectId: {}", exchange, dbObj.get("_id"));
                }
                consumer.getProcessor().process(exchange);
            } catch (Exception e) {
                LOG.warn("Exception ocurred while processing exchange with ID " + exchange.getExchangeId(), e);
                if (exchange.getException() != e) {
                    exchange.setException(e);
                }
            }
            tailTracking.setLastVal(dbObj);
        }
    } catch (CursorNotFound e) {
        // we only log the warning if we are not stopping, otherwise it is expected because the stop() method kills the cursor just in case it is blocked
        // waiting for more data to arrive
        if (keepRunning) {
            LOG.debug("Cursor not found exception from MongoDB, will regenerate cursor. This is normal behaviour with tailable cursors.", e);
        }
    }
    // the loop finished, persist the lastValue just in case we are shutting down
    // TODO: perhaps add a functionality to persist every N records
    tailTracking.persistToStore();
</td> </tr></table></body></html>