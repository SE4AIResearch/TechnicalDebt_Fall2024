<html>
 <head> 
  <style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style> 
 </head> 
 <body>
  <h1>SATD</h1>
  <table>
   <tbody>
    <tr>
     <th>satd id</th> 
     <th>satd instance id</th> 
     <th>project</th> 
     <th>committer name </th> 
     <th> Commit Hash</th> 
     <th>old comment</th> 
     <th>New Comment</th> 
     <th>resolution</th> 
     <th>Method Signature</th> 
     <th>Method Declaration</th> 
     <th>Method Body</th> 
    </tr>
    <tr>
     <td>3866</td> 
     <td>-1422649952</td>
     <td>apache/camel</td>
     <td>Candle</td>
     <td>9c99648c601097bda6c5b08360b1c45c345793d8</td> 
     <td>XXX assumes there is only one stream</td> 
     <td>XXX assumes there is only one stream</td> 
     <td>CLASS_OR_METHOD_CHANGED</td> 
     <td>getShardIterator()</td> 
     <td> // either return a cached one or get a new one via a GetShardIterator request. if (currentShardIterator == null) { ListStreamsRequest req0 = new ListStreamsRequest().withTableName(getEndpoint().getTableName()); ListStreamsResult res0 = getClient().listStreams(req0); // XXX assumes there is only one stream final String streamArn = res0.getStreams().get(0).getStreamArn(); DescribeStreamRequest req1 = new DescribeStreamRequest().withStreamArn(streamArn); DescribeStreamResult res1 = getClient().describeStream(req1); shardList.addAll(res1.getStreamDescription().getShards()); LOG.trace("Current shard is: {} (in {})", currentShard, shardList); if (currentShard == null) { switch(getEndpoint().getIteratorType()) { case AFTER_SEQUENCE_NUMBER: currentShard = shardList.afterSeq(getEndpoint().getSequenceNumber()); break; case AT_SEQUENCE_NUMBER: currentShard = shardList.atSeq(getEndpoint().getSequenceNumber()); break; case TRIM_HORIZON: currentShard = shardList.first(); break; case LATEST: default: currentShard = shardList.last(); break; } } else { currentShard = shardList.nextAfter(currentShard); } shardList.removeOlderThan(currentShard); LOG.trace("Next shard is: {} (in {})", currentShard, shardList); GetShardIteratorRequest req = new GetShardIteratorRequest().withStreamArn(streamArn).withShardId(currentShard.getShardId()).withShardIteratorType(getEndpoint().getIteratorType()); switch(getEndpoint().getIteratorType()) { case AFTER_SEQUENCE_NUMBER: case AT_SEQUENCE_NUMBER: // if you request with a sequence number that is LESS than the // start of the shard, you get a HTTP 400 from AWS. // So only add the sequence number if the endpoints // sequence number is less than or equal to the starting // sequence for the shard. // Otherwise change the shart iterator type to trim_horizon // because we get a 400 when we use one of the // {at,after}_sequence_number iterator types and don't supply // a sequence number. if (BigIntComparisons.Conditions.LTEQ.matches(new BigInteger(currentShard.getSequenceNumberRange().getStartingSequenceNumber()), new BigInteger(getEndpoint().getSequenceNumber()))) { req = req.withSequenceNumber(getEndpoint().getSequenceNumber()); } else { req = req.withShardIteratorType(ShardIteratorType.TRIM_HORIZON); } break; default: } GetShardIteratorResult result = getClient().getShardIterator(req); currentShardIterator = result.getShardIterator(); } LOG.trace("Shard Iterator is: {}", currentShardIterator); return currentShardIterator; </td> 
     <td> String getShardIterator()</td> 
    </tr>
   </tbody>
   <tbody>
    <tr>
     <td>3865</td> 
     <td>-1422649952</td>
     <td>apache/camel</td>
     <td>Candle</td>
     <td>d097871c664f17fad96c19eb014fd6bd828d1357</td> 
     <td>XXX assumes there is only one stream</td> 
     <td>XXX assumes there is only one stream</td> 
     <td>SATD_MOVED_FILE</td> 
     <td>getShardIterator()</td> 
     <td> // either return a cached one or get a new one via a GetShardIterator request. if (currentShardIterator == null) { ListStreamsRequest req0 = new ListStreamsRequest().withTableName(getEndpoint().getTableName()); ListStreamsResult res0 = getClient().listStreams(req0); // XXX assumes there is only one stream final String streamArn = res0.getStreams().get(0).getStreamArn(); DescribeStreamRequest req1 = new DescribeStreamRequest().withStreamArn(streamArn); DescribeStreamResult res1 = getClient().describeStream(req1); shardList.addAll(res1.getStreamDescription().getShards()); LOG.trace("Current shard is: {} (in {})", currentShard, shardList); if (currentShard == null) { switch(getEndpoint().getIteratorType()) { case AFTER_SEQUENCE_NUMBER: currentShard = shardList.afterSeq(getEndpoint().getSequenceNumber()); break; case AT_SEQUENCE_NUMBER: currentShard = shardList.atSeq(getEndpoint().getSequenceNumber()); break; case TRIM_HORIZON: currentShard = shardList.first(); break; case LATEST: default: currentShard = shardList.last(); break; } } else { currentShard = shardList.nextAfter(currentShard); } shardList.removeOlderThan(currentShard); LOG.trace("Next shard is: {} (in {})", currentShard, shardList); GetShardIteratorRequest req = new GetShardIteratorRequest().withStreamArn(streamArn).withShardId(currentShard.getShardId()).withShardIteratorType(getEndpoint().getIteratorType()); switch(getEndpoint().getIteratorType()) { case AFTER_SEQUENCE_NUMBER: case AT_SEQUENCE_NUMBER: // if you request with a sequence number that is LESS than the // start of the shard, you get a HTTP 400 from AWS. // So only add the sequence number if the endpoints // sequence number is less than or equal to the starting // sequence for the shard. // Otherwise change the shart iterator type to trim_horizon // because we get a 400 when we use one of the // {at,after}_sequence_number iterator types and don't supply // a sequence number. if (BigIntComparisons.Conditions.LTEQ.matches(new BigInteger(currentShard.getSequenceNumberRange().getStartingSequenceNumber()), new BigInteger(getEndpoint().getSequenceNumber()))) { req = req.withSequenceNumber(getEndpoint().getSequenceNumber()); } else { req = req.withShardIteratorType(ShardIteratorType.TRIM_HORIZON); } break; default: } GetShardIteratorResult result = getClient().getShardIterator(req); currentShardIterator = result.getShardIterator(); } LOG.trace("Shard Iterator is: {}", currentShardIterator); return currentShardIterator; </td> 
     <td> String getShardIterator()</td> 
    </tr>
   </tbody>
  </table>
 </body>
</html>