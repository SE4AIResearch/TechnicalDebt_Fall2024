<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>5528</td> <td>-1009652198</td><td>apache/hadoop</td><td>Eli Collins</td><td>a196766ea07775f18ded69bd9e8d239f8cfd3ccc</td> <td>None</td> <td>test if jobs with no tasks (0 maps, 0 red) update the listener properly</td> <td>SATD_ADDED</td> <td>testSuccessfulJob(JobConf, MyListener)</td> <td>private void testSuccessfulJob(JobConf job, MyListener myListener) throws Exception</td> <td>
    LOG.info("Testing job-success");
    Path inDir = new Path(TEST_ROOT_DIR + "/jiplistenerjob/input");
    Path outDir = new Path(TEST_ROOT_DIR + "/jiplistenerjob/output");
    job.setNumMapTasks(1);
    job.setNumReduceTasks(0);
    // submit the job
    RunningJob rJob = UtilsForTests.runJobSucceed(job, inDir, outDir);
    // wait for the job to be successful
    rJob.waitForCompletion();
    // check if the job success was notified
    assertFalse("Missing event notification for a successful job", myListener.contains(rJob.getID()));
    // check if successful
    assertEquals("Job failed!", JobStatus.SUCCEEDED, rJob.getJobState());
    // test if 0-task jobs with setup-cleanup works fine
    LOG.info("Testing job with no task job with setup and cleanup");
    job.setNumMapTasks(0);
    job.setNumReduceTasks(0);
    outDir = new Path(TEST_ROOT_DIR + "/jiplistenerjob/output-no-tasks");
    // submit the job
    rJob = UtilsForTests.runJobSucceed(job, inDir, outDir);
    // wait for the job to be successful
    rJob.waitForCompletion();
    // check if the job success was notified
    assertFalse("Missing event notification for a successful job with no tasks", myListener.contains(rJob.getID(), true));
    // check if successful
    assertEquals("Job failed!", JobStatus.SUCCEEDED, rJob.getJobState());
    // test if jobs with no tasks (0 maps, 0 red) update the listener properly
    LOG.info("Testing job with no-set-cleanup no task");
    outDir = new Path(TEST_ROOT_DIR + "/jiplistenerjob/output-no-tasks-no-set");
    Job j = MapReduceTestUtil.createJob(mr.createJobConf(), inDir, outDir, 0, 0);
    j.setJobSetupCleanupNeeded(false);
    j.setOutputFormatClass(TestNoJobSetupCleanup.MyOutputFormat.class);
    j.submit();
    j.waitForCompletion(true);
    JobID id = JobID.downgrade(j.getJobID());
    // check if the job is in the waiting queue
    assertFalse("Missing event notification on no-set-cleanup no task job", myListener.contains(id, true));
    // check if the job is successful
    assertEquals("Job status doesnt reflect success", JobStatus.SUCCEEDED, rJob.getJobState());
</td> </tr></table></body></html>