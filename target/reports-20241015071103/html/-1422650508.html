<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>2837</td> <td>-1422650508</td><td>apache/camel</td><td>Henryk Konsek</td><td>0c401b9fba53837bdea3dc486880dd0e0c6e2d6f</td> <td>None</td> <td>probably shutting down, forget unsubscribe and return</td> <td>SATD_ADDED</td> <td>unsubscribe(String, SalesforceConsumer)</td> <td>public void unsubscribe(String topicName, SalesforceConsumer consumer) throws CamelException</td> <td>
    // channel name
    final String channelName = getChannelName(topicName);
    // listen for unsubscribe error
    final CountDownLatch latch = new CountDownLatch(1);
    final String[] unsubscribeError = { null };
    final ClientSessionChannel.MessageListener unsubscribeListener = new ClientSessionChannel.MessageListener() {

        public void onMessage(ClientSessionChannel channel, Message message) {
            LOG.debug("[CHANNEL:META_UNSUBSCRIBE]: {}", message);
            String unsubscribedChannelName = message.get(SUBSCRIPTION_FIELD).toString();
            if (channelName.equals(unsubscribedChannelName)) {
                if (!message.isSuccessful()) {
                    String error = (String) message.get(ERROR_FIELD);
                    if (error != null) {
                        unsubscribeError[0] = error;
                    }
                } else {
                    // forget subscription
                    LOG.info("Unsubscribed from channel {}", unsubscribedChannelName);
                }
                latch.countDown();
            }
        }
    };
    client.getChannel(META_UNSUBSCRIBE).addListener(unsubscribeListener);
    try {
        // unsubscribe from channel
        final ClientSessionChannel.MessageListener listener = listenerMap.remove(consumer);
        if (listener != null) {
            LOG.info("Unsubscribing from channel {}...", channelName);
            final ClientSessionChannel clientChannel = client.getChannel(channelName);
            clientChannel.unsubscribe(listener);
            // confirm unsubscribe
            try {
                if (!latch.await(CHANNEL_TIMEOUT, SECONDS)) {
                    String message;
                    if (unsubscribeError[0] != null) {
                        message = String.format("Error unsubscribing from topic %s: %s", topicName, unsubscribeError[0]);
                    } else {
                        message = String.format("Timeout error unsubscribing from topic %s after %s seconds", topicName, CHANNEL_TIMEOUT);
                    }
                    throw new CamelException(message);
                }
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            // probably shutting down, forget unsubscribe and return
            }
        }
    } finally {
        client.getChannel(META_UNSUBSCRIBE).removeListener(unsubscribeListener);
    }
</td> </tr></table></body></html>