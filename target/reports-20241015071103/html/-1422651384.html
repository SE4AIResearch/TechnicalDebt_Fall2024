<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>1290</td> <td>-1422651384</td><td>apache/camel</td><td>Willem Ning Jiang</td><td>b64e8a8c4b15c88b0cb86c5b64f1ed1c8d1292cd</td> <td>None</td> <td>TODO: we need a new API for getting the result</td> <td>SATD_ADDED</td> <td>testAsyncWithSeda()</td> <td>public void testAsyncWithSeda() throws Exception</td> <td>
    MockEndpoint mock = getMockEndpoint("mock:result");
    mock.expectedMessageCount(1);
    Endpoint endpoint = context.getEndpoint("seda:start");
    Producer producer = endpoint.createProducer();
    Exchange exchange = producer.createExchange(ExchangePattern.InOut);
    exchange.getIn().setBody("Hello World");
    // seda producer is async also (but this is ugly to need to cast)
    AsyncProcessor async = (AsyncProcessor) producer;
    boolean sync = async.process(exchange, new AsyncCallback() {

        public void done(boolean sync) {
            // we expect 2 callbacks
            // the first is when we have finished sending to the seda producer
            if (sync) {
                doneSync = true;
            } else {
                latchAsync.countDown();
            }
        }
    });
    // I should happen before mock
    route = route + "send";
    assertMockEndpointsSatisfied();
    assertEquals("Send should occur before processor", "sendprocess", route);
    assertTrue("Sync done should have occured", doneSync);
    // wait at most 2 seconds
    boolean zero = latchAsync.await(2, TimeUnit.SECONDS);
    assertTrue("Async done should have occured", zero);
    // how to get the response?
    String response = exchange.getOut().getBody(String.class);
// TODO: we need a new API for getting the result
// assertEquals("Bye World", response);
</td> </tr></table></body></html>