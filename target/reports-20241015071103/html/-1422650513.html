<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>2832</td> <td>-1422650513</td><td>apache/camel</td><td>Henryk Konsek</td><td>0c401b9fba53837bdea3dc486880dd0e0c6e2d6f</td> <td>None</td> <td>get event data
TODO do we need to add NPE checks for message/data.get***???</td> <td>SATD_ADDED</td> <td>processMessage(ClientSessionChannel, Message)</td> <td>public void processMessage(ClientSessionChannel channel, Message message)</td> <td>
    final Exchange exchange = endpoint.createExchange();
    org.apache.camel.Message in = exchange.getIn();
    setHeaders(in, message);
    // get event data
    // TODO do we need to add NPE checks for message/data.get***???
    Map<String, Object> data = message.getDataAsMap();
    @SuppressWarnings("unchecked")
    final Map<String, Object> event = (Map<String, Object>) data.get(EVENT_PROPERTY);
    final Object eventType = event.get(TYPE_PROPERTY);
    Object createdDate = event.get(CREATED_DATE_PROPERTY);
    if (log.isDebugEnabled()) {
        log.debug(String.format("Received event %s on channel %s created on %s", eventType, channel.getChannelId(), createdDate));
    }
    in.setHeader("CamelSalesforceEventType", eventType);
    in.setHeader("CamelSalesforceCreatedDate", createdDate);
    // get SObject
    @SuppressWarnings("unchecked")
    final Map<String, Object> sObject = (Map<String, Object>) data.get(SOBJECT_PROPERTY);
    try {
        final String sObjectString = objectMapper.writeValueAsString(sObject);
        log.debug("Received SObject: {}", sObjectString);
        if (sObjectClass == null) {
            // return sobject map as exchange body
            in.setBody(sObject);
        } else {
            // create the expected SObject
            in.setBody(objectMapper.readValue(new StringReader(sObjectString), sObjectClass));
        }
    } catch (IOException e) {
        final String msg = String.format("Error parsing message [%s] from Topic %s: %s", message, topicName, e.getMessage());
        handleException(msg, new RuntimeCamelException(msg, e));
    }
    try {
        getAsyncProcessor().process(exchange, new AsyncCallback() {

            public void done(boolean doneSync) {
                // noop
                if (log.isTraceEnabled()) {
                    log.trace("Done processing event: {} {}", eventType.toString(), doneSync ? "synchronously" : "asynchronously");
                }
            }
        });
    } catch (Exception e) {
        handleException(String.format("Error processing %s: %s", exchange, e.getMessage()), e);
    } finally {
        Exception ex = exchange.getException();
        if (ex != null) {
            handleException(String.format("Unhandled exception: %s", ex.getMessage()), ex);
        }
    }
</td> </tr></table></body></html>