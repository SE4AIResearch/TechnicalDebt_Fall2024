<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>4627</td> <td>1242677984</td><td>GerritCodeReview/gerrit</td><td>Dave Borowitz</td><td>d064abea4f107cdb4293ca0fccc02c5ee3fc4d0b</td> <td>None</td> <td>TODO(dborowitz): Store normalized labels in notedb.</td> <td>SATD_ADDED</td> <td>saveApprovals(Change, ChangeNotes, PatchSet.Id)</td> <td>private PatchSetApproval saveApprovals(Change c, ChangeNotes notes, PatchSet.Id merged) throws OrmException</td> <td>
    // Flatten out existing approvals for this patch set based upon the current
    // permissions. Once the change is closed the approvals are not updated at
    // presentation view time, except for zero votes used to indicate a reviewer
    // was added. So we need to make sure votes are accurate now. This way if
    // permissions get modified in the future, historical records stay accurate.
    PatchSetApproval submitter = null;
    try {
        List<PatchSetApproval> approvals = approvalsUtil.byPatchSet(db, notes, merged);
        Set<PatchSetApproval.Key> toDelete = Sets.newHashSetWithExpectedSize(approvals.size());
        for (PatchSetApproval a : approvals) {
            if (a.getValue() != 0) {
                toDelete.add(a.getKey());
            }
        }
        approvals = labelNormalizer.normalize(c, approvals);
        for (PatchSetApproval a : approvals) {
            toDelete.remove(a.getKey());
            if (a.getValue() > 0 && a.isSubmit()) {
                if (submitter == null || a.getGranted().compareTo(submitter.getGranted()) > 0) {
                    submitter = a;
                }
            }
        }
        // TODO(dborowitz): Store normalized labels in notedb.
        db.patchSetApprovals().update(approvals);
        db.patchSetApprovals().deleteKeys(toDelete);
    } catch (NoSuchChangeException err) {
        throw new OrmException(err);
    }
    return submitter;
</td> </tr></table></body></html>