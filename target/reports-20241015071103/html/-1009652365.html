<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>5361</td> <td>-1009652365</td><td>apache/hadoop</td><td>Eli Collins</td><td>a196766ea07775f18ded69bd9e8d239f8cfd3ccc</td> <td>None</td> <td>TODO: test create schema
TODO: test writable variants of data types</td> <td>SATD_ADDED</td> <td>testVerticaOutput()</td> <td>public void testVerticaOutput() throws Exception</td> <td>
    if (!AllTests.isSetup()) {
        return;
    }
    // TODO: test create schema
    // TODO: test writable variants of data types
    VerticaOutputFormat output = new VerticaOutputFormat();
    Job job = getVerticaJob();
    VerticaOutputFormat.setOutput(job, "mrtarget", true, "a int", "b boolean", "c char(1)", "d date", "f float", "t timestamp", "v varchar", "z varbinary");
    output.checkOutputSpecs(job, true);
    TaskAttemptContext context = new TaskAttemptContextImpl(job.getConfiguration(), new TaskAttemptID());
    VerticaRecordWriter writer = (VerticaRecordWriter) output.getRecordWriter(context);
    Text table = new Text();
    table.set("mrtarget");
    VerticaRecord record = VerticaOutputFormat.getValue(job.getConfiguration());
    record.set(0, 125, true);
    record.set(1, true, true);
    record.set(2, 'c', true);
    record.set(3, Calendar.getInstance().getTime(), true);
    record.set(4, 234.526, true);
    record.set(5, Calendar.getInstance().getTime(), true);
    record.set(6, "foobar string", true);
    record.set(7, new byte[10], true);
    writer.write(table, record);
    writer.close(null);
</td> </tr></table></body></html>