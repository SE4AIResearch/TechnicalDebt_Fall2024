<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>2291</td> <td>-1422650837</td><td>apache/camel</td><td>Claus Ibsen</td><td>6f15ad513cc7ed705261576840e1a6a06bb834fe</td> <td>None</td> <td>must extract the absolute name before the begin strategy as the file could potentially be pre moved
and then the file name would be changed</td> <td>SATD_ADDED</td> <td>processExchange(Exchange)</td> <td>protected void processExchange(final Exchange exchange)</td> <td>
    GenericFile<T> file = getExchangeFileProperty(exchange);
    log.trace("Processing file: {}", file);
    // must extract the absolute name before the begin strategy as the file could potentially be pre moved
    // and then the file name would be changed
    String absoluteFileName = file.getAbsoluteFilePath();
    // check if we can begin processing the file
    try {
        final GenericFileProcessStrategy<T> processStrategy = consumer.getEndpoint().getGenericFileProcessStrategy();
        boolean begin = processStrategy.begin(consumer.getOperations(), consumer.getEndpoint(), exchange, file);
        if (!begin) {
            log.debug(consumer.getEndpoint() + " cannot begin processing file: {}", file);
            // begin returned false, so remove file from the in progress list as its no longer in progress
            consumer.getEndpoint().getInProgressRepository().remove(absoluteFileName);
            return;
        }
    } catch (Exception e) {
        if (log.isDebugEnabled()) {
            log.debug(consumer.getEndpoint() + " cannot begin processing file: " + file + " due to: " + e.getMessage(), e);
        }
        consumer.getEndpoint().getInProgressRepository().remove(absoluteFileName);
        return;
    }
    // must use file from exchange as it can be updated due the
    // preMoveNamePrefix/preMoveNamePostfix options
    final GenericFile<T> target = getExchangeFileProperty(exchange);
    // must use full name when downloading so we have the correct path
    final String name = target.getAbsoluteFilePath();
    try {
        // retrieve the file using the stream
        log.trace("Retrieving file: {} from: {}", name, consumer.getEndpoint());
        // retrieve the file and check it was a success
        boolean retrieved = consumer.getOperations().retrieveFile(name, exchange);
        if (!retrieved) {
            // throw exception to handle the problem with retrieving the file
            // then if the method return false or throws an exception is handled the same in here
            // as in both cases an exception is being thrown
            throw new GenericFileOperationFailedException("Cannot retrieve file: " + file + " from: " + consumer.getEndpoint());
        }
        log.trace("Retrieved file: {} from: {}", name, consumer.getEndpoint());
        // register on completion callback that does the completion strategies
        // (for instance to move the file after we have processed it)
        exchange.addOnCompletion(new GenericFileOnCompletion<T>(consumer.getEndpoint(), consumer.getOperations(), target, absoluteFileName));
        log.debug("About to process file: {} using exchange: {}", target, exchange);
        // process the file
        processFileStrategy(exchange);
    } catch (Exception e) {
        // remove file from the in progress list due to failure
        // (cannot be in finally block due to GenericFileOnCompletion will remove it
        // from in progress when it takes over and processes the file, which may happen
        // by another thread at a later time. So its only safe to remove it if there was an exception)
        consumer.getEndpoint().getInProgressRepository().remove(absoluteFileName);
        handleExceptionStrategy(e);
    }
</td> </tr></table></body></html>