<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>828</td> <td>-1422651586</td><td>apache/camel</td><td>Claus Ibsen</td><td>21cde38d6793ce082857c523595a44b0a4808324</td> <td>TODO add the fault message handling work</td> <td>copy the response context to the response</td> <td>SATD_REMOVED</td> <td>process(CxfExchange)</td> <td>public void process(CxfExchange exchange) throws Exception</td> <td>
    Message inMessage = CxfBinding.createCxfMessage(endpoint.getHeaderFilterStrategy(), exchange);
    exchange.setProperty(CxfExchange.DATA_FORMAT, dataFormat);
    if (dataFormat.equals(DataFormat.POJO)) {
        // InputStream is = m.getContent(InputStream.class);
        // now we just deal with the POJO invocations
        List parameters = inMessage.getContent(List.class);
        if (parameters == null) {
            parameters = new ArrayList();
        }
        String operationName = exchange.getIn().getHeader(CxfConstants.OPERATION_NAME, String.class);
        String operationNameSpace = exchange.getIn().getHeader(CxfConstants.OPERATION_NAMESPACE, String.class);
        // Get context from message
        Map<String, Object> context = new HashMap<String, Object>();
        Map<String, Object> responseContext = CxfBinding.propogateContext(inMessage, context);
        Message response = new MessageImpl();
        if (operationName != null) {
            // we need to check out the operation Namespace
            Object[] result = null;
            // call for the client with the parameters
            result = invokeClient(operationNameSpace, operationName, parameters, context);
            if (result != null) {
                response.setContent(List.class, new MessageContentsList(result));
            } else {
                response.setContent(List.class, new MessageContentsList());
            }
            // copy the response context to the response
            CxfBinding.storeCXfResponseContext(response, responseContext);
            CxfBinding.storeCxfResponse(endpoint.getHeaderFilterStrategy(), exchange, response);
        } else {
            throw new RuntimeCamelException("Can't find the operation name in the message!");
        }
    } else {
        // get the invocation context
        org.apache.cxf.message.Exchange ex = exchange.getExchange();
        if (ex == null) {
            ex = (org.apache.cxf.message.Exchange) exchange.getProperty(CxfConstants.CXF_EXCHANGE);
            exchange.setExchange(ex);
        }
        if (ex == null) {
            ex = new ExchangeImpl();
            exchange.setExchange(ex);
        }
        assert ex != null;
        InvokingContext invokingContext = ex.get(InvokingContext.class);
        if (invokingContext == null) {
            invokingContext = InvokingContextFactory.createContext(dataFormat);
            ex.put(InvokingContext.class, invokingContext);
        }
        Map<Class, Object> params = invokingContext.getRequestContent(inMessage);
        // invoke the stream message with the exchange context
        CxfClient cxfClient = (CxfClient) client;
        // need to get the binding object to create the message
        BindingOperationInfo boi = ex.get(BindingOperationInfo.class);
        Message response = null;
        if (boi == null) {
            // it should be the raw message
            response = new MessageImpl();
        } else {
            // create the message here
            Endpoint ep = ex.get(Endpoint.class);
            response = ep.getBinding().createMessage();
        }
        response.setExchange(ex);
        // invoke the message prepare the context
        Map<String, Object> context = new HashMap<String, Object>();
        Map<String, Object> responseContext = CxfBinding.propogateContext(inMessage, context);
        Object result = cxfClient.dispatch(params, context, ex);
        ex.setOutMessage(response);
        invokingContext.setResponseContent(response, result);
        // copy the response context to the response
        CxfBinding.storeCXfResponseContext(response, responseContext);
        CxfBinding.storeCxfResponse(endpoint.getHeaderFilterStrategy(), exchange, response);
    }
</td> </tr></table></body></html>