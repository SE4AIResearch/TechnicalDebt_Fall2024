<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>4410</td> <td>1242677874</td><td>GerritCodeReview/gerrit</td><td>Martin Fick</td><td>43f7940111973c589d3d8f4cee00d8c43dadd032</td> <td>None</td> <td>TODO Support arbitrary label names.</td> <td>SATD_ADDED</td> <td>updateLabels(RevisionResource, Map<String, Short>)</td> <td>private void updateLabels(RevisionResource rsrc, Map<String, Short> labels) throws OrmException</td> <td>
    List<PatchSetApproval> del = Lists.newArrayList();
    List<PatchSetApproval> ins = Lists.newArrayList();
    List<PatchSetApproval> upd = Lists.newArrayList();
    Map<String, PatchSetApproval> current = scanLabels(rsrc, del);
    for (Map.Entry<String, Short> ent : labels.entrySet()) {
        // TODO Support arbitrary label names.
        ApprovalType at = approvalTypes.byLabel(ent.getKey());
        String name = at.getCategory().getLabelName();
        PatchSetApproval c = current.get(name);
        if (ent.getValue() == null || ent.getValue() == 0) {
            // User requested delete of this label.
            if (c != null) {
                del.add(c);
                labelDelta.add("-" + name);
            }
            continue;
        }
        if (c != null && c.getValue() != ent.getValue()) {
            c.setValue(ent.getValue());
            c.setGranted(timestamp);
            c.cache(change);
            upd.add(c);
            labelDelta.add(format(name, c.getValue()));
            categories.put(at.getCategory().getId(), at.getValue(c.getValue()).getId());
        } else if (c == null) {
            c = new PatchSetApproval(new PatchSetApproval.Key(rsrc.getPatchSet().getId(), rsrc.getAuthorId(), at.getCategory().getId()), ent.getValue());
            c.setGranted(timestamp);
            c.cache(change);
            ins.add(c);
            labelDelta.add(format(name, c.getValue()));
            categories.put(at.getCategory().getId(), at.getValue(c.getValue()).getId());
        }
    }
    db.patchSetApprovals().delete(del);
    db.patchSetApprovals().insert(ins);
    db.patchSetApprovals().update(upd);
</td> </tr></table></body></html>