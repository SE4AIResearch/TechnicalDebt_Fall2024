<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>3592</td> <td>-1422650117</td><td>apache/camel</td><td>Claus Ibsen</td><td>b6bdbc24159eae45e2e4042c456c8d4a294fdbd9</td> <td>None</td> <td>TODO: include the stats from the route mbean as that would be the same</td> <td>SATD_ADDED</td> <td>parseXml(CamelContext, InputStream)</td> <td>public static Document parseXml(final CamelContext camelContext, final InputStream is) throws Exception</td> <td>
    final Document doc;
    SAXParser parser;
    final SAXParserFactory factory = SAXParserFactory.newInstance();
    parser = factory.newSAXParser();
    final DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
    final DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
    doc = docBuilder.newDocument();
    final Stack<Element> elementStack = new Stack<Element>();
    final StringBuilder textBuffer = new StringBuilder();
    final DefaultHandler handler = new DefaultHandler() {

        private Locator locator;

        @Override
        public void setDocumentLocator(final Locator locator) {
            // Save the locator, so that it can be used later for line tracking when traversing nodes.
            this.locator = locator;
        }

        @Override
        public void startElement(final String uri, final String localName, final String qName, final Attributes attributes) throws SAXException {
            addTextIfNeeded();
            final Element el = doc.createElement(qName);
            // add other elements
            for (int i = 0; i < attributes.getLength(); i++) {
                el.setAttribute(attributes.getQName(i), attributes.getValue(i));
            }
            String id = el.getAttribute("id");
            if (id != null) {
                try {
                    if ("route".equals(qName)) {
                        ManagedRouteMBean route = camelContext.getManagedRoute(id, ManagedRouteMBean.class);
                        if (route != null) {
                            long total = route.getExchangesTotal();
                            el.setAttribute("exchangesTotal", "" + total);
                            long totalTime = route.getTotalProcessingTime();
                            el.setAttribute("totalProcessingTime", "" + totalTime);
                        }
                    } else if ("from".equals(qName)) {
                    // TODO: include the stats from the route mbean as that would be the same
                    } else {
                        ManagedProcessorMBean processor = camelContext.getManagedProcessor(id, ManagedProcessorMBean.class);
                        if (processor != null) {
                            long total = processor.getExchangesTotal();
                            el.setAttribute("exchangesTotal", "" + total);
                            long totalTime = processor.getTotalProcessingTime();
                            el.setAttribute("totalProcessingTime", "" + totalTime);
                        }
                    }
                } catch (Exception e) {
                // ignore
                }
            }
            // we do not want customId in output
            el.removeAttribute("customId");
            elementStack.push(el);
        }

        @Override
        public void endElement(final String uri, final String localName, final String qName) {
            addTextIfNeeded();
            final Element closedEl = elementStack.pop();
            if (elementStack.isEmpty()) {
                // Is this the root element?
                doc.appendChild(closedEl);
            } else {
                final Element parentEl = elementStack.peek();
                parentEl.appendChild(closedEl);
            }
        }

        @Override
        public void characters(final char[] ch, final int start, final int length) throws SAXException {
            textBuffer.append(ch, start, length);
        }

        // Outputs text accumulated under the current node
        private void addTextIfNeeded() {
            if (textBuffer.length() > 0) {
                final Element el = elementStack.peek();
                final Node textNode = doc.createTextNode(textBuffer.toString());
                el.appendChild(textNode);
                textBuffer.delete(0, textBuffer.length());
            }
        }
    };
    parser.parse(is, handler);
    return doc;
</td> </tr></table></body></html>