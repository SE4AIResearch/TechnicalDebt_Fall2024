<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>5987</td> <td>-1009651781</td><td>apache/hadoop</td><td>Steve Loughran</td><td>28e6a4e44a3e920dcaf858f9a74a6358226b3a63</td> <td>None</td> <td>Calling recover should move it aside</td> <td>SATD_ADDED</td> <td>testLogGroupRecoveryMixed()</td> <td>public void testLogGroupRecoveryMixed() throws IOException</td> <td>
    FSImageTransactionalStorageInspector inspector = new FSImageTransactionalStorageInspector();
    inspector.inspectDirectory(mockDirectoryWithEditLogs("/foo1/current/" + getFinalizedEditsFileName(123, 456)));
    inspector.inspectDirectory(mockDirectoryWithEditLogs("/foo2/current/" + getFinalizedEditsFileName(123, 456)));
    inspector.inspectDirectory(mockDirectoryWithEditLogs("/foo3/current/" + getInProgressEditsFileName(123)));
    inspector.inspectDirectory(mockDirectory(NameNodeDirType.IMAGE, false, "/foo4/current/" + getImageFileName(122)));
    LogGroup lg = inspector.logGroups.get(123L);
    assertEquals(3, lg.logs.size());
    FoundEditLog inProgressLog = lg.logs.get(2);
    assertTrue(inProgressLog.isInProgress());
    LoadPlan plan = inspector.createLoadPlan();
    // Check that it was marked corrupt.
    assertFalse(lg.logs.get(0).isCorrupt());
    assertFalse(lg.logs.get(1).isCorrupt());
    assertTrue(lg.logs.get(2).isCorrupt());
    // Calling recover should move it aside
    inProgressLog = spy(inProgressLog);
    Mockito.doNothing().when(inProgressLog).moveAsideCorruptFile();
    lg.logs.set(2, inProgressLog);
    plan.doRecovery();
    Mockito.verify(inProgressLog).moveAsideCorruptFile();
</td> </tr></table></body></html>