<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>3698</td> <td>-1422650060</td><td>apache/camel</td><td>Claus Ibsen</td><td>bf36f6149d3280e160cee8be12fd03ada3e81d35</td> <td>None</td> <td>TODO: like response object with type refer to model</td> <td>SATD_ADDED</td> <td>read(RestDefinition, BeanConfig, ClassResolver)</td> <td>public Swagger read(RestDefinition rest, BeanConfig config, ClassResolver classResolver)</td> <td>
    Swagger swagger = new Swagger();
    config.configure(swagger);
    List<VerbDefinition> verbs = new ArrayList<>(rest.getVerbs());
    // must sort the verbs by uri so we group them together when an uri has multiple operations
    Collections.sort(verbs, new VerbOrdering());
    // gather all types in use
    Set<String> types = new LinkedHashSet<>();
    for (VerbDefinition verb : verbs) {
        String type = verb.getType();
        if (type != null) {
            if (type.endsWith("[]")) {
                type = type.substring(0, type.length() - 2);
            }
            types.add(type);
        }
        type = verb.getOutType();
        if (type != null) {
            if (type.endsWith("[]")) {
                type = type.substring(0, type.length() - 2);
            }
            types.add(type);
        }
    }
    // use annotation scanner to find models (annotated classes)
    for (String type : types) {
        Class<?> clazz = classResolver.resolveClass(type);
        appendModels(clazz, swagger);
    }
    // used during gathering of apis
    List<Path> paths = new ArrayList<>();
    String basePath = rest.getPath();
    for (VerbDefinition verb : verbs) {
        // the method must be in lower case
        String method = verb.asVerb().toLowerCase(Locale.US);
        // operation path is a key
        String opPath = SwaggerHelper.buildUrl(basePath, verb.getUri());
        Operation op = new Operation();
        Path path = swagger.getPath(opPath);
        if (path == null) {
            path = new Path();
            paths.add(path);
        }
        path = path.set(method, op);
        String consumes = verb.getConsumes() != null ? verb.getConsumes() : rest.getConsumes();
        if (consumes != null) {
            String[] parts = consumes.split(",");
            for (String part : parts) {
                op.addConsumes(part);
            }
        }
        String produces = verb.getProduces() != null ? verb.getProduces() : rest.getProduces();
        if (produces != null) {
            String[] parts = produces.split(",");
            for (String part : parts) {
                op.addProduces(part);
            }
        }
        if (verb.getDescriptionText() != null) {
            op.summary(verb.getDescriptionText());
        }
        for (RestOperationParamDefinition param : verb.getParams()) {
            Parameter parameter = null;
            if (param.getType().equals(RestParamType.body)) {
                parameter = new BodyParameter();
            } else if (param.getType().equals(RestParamType.form)) {
                parameter = new FormParameter();
            } else if (param.getType().equals(RestParamType.header)) {
                parameter = new HeaderParameter();
            } else if (param.getType().equals(RestParamType.path)) {
                parameter = new PathParameter();
            } else if (param.getType().equals(RestParamType.query)) {
                parameter = new QueryParameter();
            }
            if (parameter != null) {
                parameter.setName(param.getName());
                parameter.setAccess(param.getAccess());
                parameter.setDescription(param.getDescription());
                parameter.setRequired(param.getRequired());
                if (parameter instanceof SerializableParameter) {
                    SerializableParameter sp = (SerializableParameter) parameter;
                    // TODO: like response object with type refer to model
                    if (param.getDataType() != null) {
                        sp.setType(param.getDataType());
                    } else if (verb.getType() != null) {
                        boolean array = verb.getType().endsWith("[]");
                        if (array) {
                            sp.setType("array");
                        } else {
                            sp.setType(verb.getType());
                        }
                    }
                }
                op.addParameter(parameter);
            }
        }
        if (verb.getOutType() != null) {
            Response response = new Response();
            boolean array = verb.getOutType().endsWith("[]");
            String type = array ? verb.getOutType().substring(0, verb.getOutType().length() - 2) : verb.getOutType();
            // lookup in models to use key instead of FQN
            for (Model model : swagger.getDefinitions().values()) {
                StringProperty modelType = (StringProperty) model.getVendorExtensions().get("x-className");
                if (modelType != null && type.equals(modelType.getFormat())) {
                    type = ((ModelImpl) model).getName();
                    break;
                }
            }
            if (array) {
                response.setSchema(new ArrayProperty(new RefProperty(type)));
            } else {
                response.setSchema(new RefProperty(type));
            }
            response.setDescription("Output type");
            op.addResponse("200", response);
        }
        for (RestOperationResponseMsgDefinition msg : verb.getResponseMsgs()) {
            Response response = new Response();
            response.setDescription(msg.getMessage());
            op.addResponse("" + msg.getCode(), response);
        }
        // add path
        swagger.path(opPath, path);
    }
    return swagger;
</td> </tr></table></body></html>