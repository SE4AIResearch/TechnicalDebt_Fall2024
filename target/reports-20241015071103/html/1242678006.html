<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>4665</td> <td>1242678006</td><td>GerritCodeReview/gerrit</td><td>David Ostrovsky</td><td>14fcdd7458ea1c870b6fd2a3cedb9d57e1f26c8b</td> <td>None</td> <td>TODO(davido): Allow to resolve conflicts inline</td> <td>SATD_ADDED</td> <td>rebaseEdit(ChangeEdit, PatchSet)</td> <td>public RefUpdate.Result rebaseEdit(ChangeEdit edit, PatchSet current) throws AuthException, InvalidChangeOperationException, IOException</td> <td>
    if (!currentUser.get().isIdentifiedUser()) {
        throw new AuthException("Authentication required");
    }
    Change change = edit.getChange();
    IdentifiedUser me = (IdentifiedUser) currentUser.get();
    String refName = editRefName(me.getAccountId(), change.getId());
    Repository repo = gitManager.openRepository(change.getProject());
    try {
        RevWalk rw = new RevWalk(repo);
        ObjectInserter inserter = repo.newObjectInserter();
        try {
            RevCommit editCommit = edit.getEditCommit();
            RevCommit mergeTip = rw.parseCommit(ObjectId.fromString(current.getRevision().get()));
            ThreeWayMerger m = MergeStrategy.RESOLVE.newMerger(repo, true);
            m.setObjectInserter(inserter);
            m.setBase(editCommit.getParent(0));
            if (m.merge(mergeTip, editCommit)) {
                ObjectId tree = m.getResultTreeId();
                CommitBuilder mergeCommit = new CommitBuilder();
                mergeCommit.setTreeId(tree);
                mergeCommit.setParentId(mergeTip);
                mergeCommit.setAuthor(editCommit.getAuthorIdent());
                mergeCommit.setCommitter(new PersonIdent(editCommit.getCommitterIdent(), TimeUtil.nowTs()));
                mergeCommit.setMessage(editCommit.getFullMessage());
                ObjectId newEdit = inserter.insert(mergeCommit);
                inserter.flush();
                return update(repo, me, refName, rw, editCommit, newEdit);
            } else {
                // TODO(davido): Allow to resolve conflicts inline
                throw new InvalidChangeOperationException("merge conflict");
            }
        } finally {
            rw.release();
            inserter.release();
        }
    } finally {
        repo.close();
    }
</td> </tr></table></body></html>