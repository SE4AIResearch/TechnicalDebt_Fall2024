<html><head>
<style> table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}th {
  background: lightblue;
}</style>
</head> <body><h1>SATD</h1><table><tr><th>satd id</th> <th>satd instance id</th>  <th>project</th> <th>committer name </th> <th> Commit Hash</th> <th>old comment</th> <th>New Comment</th> <th>resolution</th> <th>Method Signature</th> <th>Method Declaration</th> <th>Method Body</th> </tr><tr><td>1437</td> <td>-1422651314</td><td>apache/camel</td><td>Claus Ibsen</td><td>bc1f27fb2a699a053b02ccbe0310323b05be3fa9</td> <td>None</td> <td>TODO: just a little more to avoid logging the last intercepted step</td> <td>SATD_ADDED</td> <td>process(Exchange)</td> <td>public void process(final Exchange exchange) throws Exception</td> <td>
    // interceptor will also trace routes supposed only for TraceEvents so we need to skip
    // logging TraceEvents to avoid infinite looping
    if (exchange instanceof TraceEventExchange || exchange.getProperty(TRACE_EVENT, Boolean.class) != null) {
        // but we must still process to allow routing of TraceEvents to eg a JPA endpoint
        super.process(exchange);
        return;
    }
    boolean shouldLog = shouldLogNode(node) && shouldLogExchange(exchange);
    // okay this is a regular exchange being routed we might need to log and trace
    try {
        // before
        if (shouldLog) {
            // if traceable then register this as the previous node, now it has been logged
            if (exchange.getUnitOfWork() instanceof TraceableUnitOfWork) {
                TraceableUnitOfWork tuow = (TraceableUnitOfWork) exchange.getUnitOfWork();
                // special for on exception so we can see it in the trace logs
                if (node instanceof OnExceptionDefinition) {
                    Processor pseudo = new Processor() {

                        public void process(Exchange exchange) throws Exception {
                        }

                        public String toString() {
                            String name = exchange.getProperty(Exchange.EXCEPTION_CAUGHT, Exception.class).getClass().getSimpleName();
                            return "onException[" + name + "]";
                        }
                    };
                    tuow.addTraced(new DefaultRouteNode(pseudo, node));
                    // log and trace the processor that was onException so we can see it
                    logExchange(exchange);
                    traceExchange(exchange);
                }
                // register the processor that was traced
                tuow.addTraced(new DefaultRouteNode(super.getProcessor(), node));
            }
            // TODO: just a little more to avoid logging the last intercepted step
            // log and trace the processor
            logExchange(exchange);
            traceExchange(exchange);
            // some nodes need extra work to trace it
            if (exchange.getUnitOfWork() instanceof TraceableUnitOfWork) {
                TraceableUnitOfWork tuow = (TraceableUnitOfWork) exchange.getUnitOfWork();
                // special for intercept() as we would like to trace the processor that was intercepted
                // as well, otherwise we only see the intercepted route, but we need the both to be logged/traced
                if (node instanceof InterceptDefinition) {
                    // get the intercepted processor from the definition
                    // we need to use the UoW to have its own index of how far we got into the list
                    // of intercepted processors the intercept definition holds as the intercept
                    // definition is a single object that is shared by concurrent thread being routed
                    // so each exchange has its own private counter
                    InterceptDefinition intercept = (InterceptDefinition) node;
                    Processor last = intercept.getInterceptedProcessor(tuow.getAndIncrement(intercept));
                    if (last != null) {
                        tuow.addTraced(new DefaultRouteNode(last, node));
                        // log and trace the processor that was intercepted so we can see it
                        logExchange(exchange);
                        traceExchange(exchange);
                    }
                }
            }
        }
        // process the exchange
        super.proceed(exchange);
        // after (trace out)
        if (shouldLog && tracer.isTraceOutExchanges()) {
            logExchange(exchange);
            traceExchange(exchange);
        }
    } catch (Exception e) {
        if (shouldLogException(exchange)) {
            logException(exchange, e);
        }
        throw e;
    }
</td> </tr></table></body></html>